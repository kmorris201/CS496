{% extends 'base.html' %}
{% load static %}
{% block title %}{{ topic.subject }}{% endblock %}
{% block breadcrumb %}
  <li><a href="{% url 'home' %}">Forums</a>/</li>
  <li><a href="{% url 'forum_topics' topic.forum.pk %}">{{ topic.forum.name }}</a>/</li>
  <li>{{ topic.subject }}</li>
{% endblock %}

{% block content %}
  <div class="mb-4">
    <a href="{% url 'replies' topic.forum.pk topic.pk %}" class="btn btn-dark" role="button">Reply</a>
  </div>

  {% for post in topic.posts.all %}
    
        <div class="row">
          <div class="col">
            <div class="row">
              <div class="col">
                <strong class="text-muted">{{ post.created_by.username }}</strong>
              </div>
              <div class="col" align="right">
                <small class="text-muted">{{ post.created_at }}</small>
              </div>
            </div>
            {{ post.message }}
			{% if post.files %}
			
			<div>
			<br>
			<a href="{% static '/media/' %}{{ post.files }}" download="files{{ post.files }}" 
			class = "btn btn-dark" role="button">
			{{ post.files }}</a>
			</div>
			{% endif %}
			{% if post.created_by == user %}
              <div class="mt-3">
					<a href="{% url 'post_edit' post.topic.forum.pk post.topic.pk post.pk %}"
					class="btn btn-light btn-sm"
					role="button">Edit</a>
			   </div>
			{% elif user.is_staff%}
			  <div class="mt-3">
                	<a href="{% url 'post_edit' post.topic.forum.pk post.topic.pk post.pk %}"
					class="btn btn-light btn-sm"
					role="button">Edit</a>
              </div>
            {% endif %}
          </div>
    </div>
	<hr>
  {% endfor %}
{% endblock %}